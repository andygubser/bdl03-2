{"paragraphs":[{"text":"%md\n# Prototype 1","user":"bd01","dateUpdated":"2021-02-04T10:29:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Prototype 1</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1612434548091_398048288","id":"20210127-071031_1944670894","dateCreated":"2021-02-04T10:29:08+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:663"},{"text":"%md\n## Settings\n* Review active interpreters: md (needs to be on the top), spark2, sh, shUser\n* Review correct file to analyse in %sh and %spark2.pyspark\n","user":"bd01","dateUpdated":"2021-02-04T12:57:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612442873827_1475982537","id":"20210204-124753_933285857","dateCreated":"2021-02-04T12:47:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2027","dateFinished":"2021-02-04T12:57:50+0000","dateStarted":"2021-02-04T12:57:50+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Settings</h2>\n<ul>\n  <li>Review active interpreters: md (needs to be on the top), spark2, sh, shUser</li>\n  <li>Review correct file to analyse in %sh and %spark2.pyspark</li>\n</ul>\n</div>"}]}},{"text":"%md\n## Bring the data to the GW","user":"bd01","dateUpdated":"2021-02-04T12:46:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612442773454_-1299160623","id":"20210204-124613_558847832","dateCreated":"2021-02-04T12:46:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1635","dateFinished":"2021-02-04T12:46:40+0000","dateStarted":"2021-02-04T12:46:40+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Bring the data to the GW</h2>\n</div>"}]}},{"text":"%sh\nDIR=/home/zeppelin/project\n\nBASE_URL=\"https://data.open-power-system-data.org/household_data/2020-04-15/\"\n\n# blocksize (HDFS) is 8 MB\n# FILE='household_data_1min_singleindex.csv'        #  1min granularity    # data for project\n# FILE='household_data_15min_singleindex.csv'       # 15min granularity    # data for second prototype\nFILE='household_data_60min_singleindex.csv'       # 60min granualrity    # data for prototype\n\nURL=$BASE_URL/$FILE\n\n# download into the GW - but just once\n\necho \"----create-DIR----\"\ntest -d $DIR || mkdir $DIR\n\necho \"----before-curl---\"\nls -lh $DIR\n\necho \"----after-curl----\"\ntest -f $DIR/$FILE || curl -sSlO $URL\nls -lh $DIR\n\necho \"----hdfs----\"\nhdfs dfs -test -f $FILE      || hdfs dfs -put $DIR/$FILE .\nhdfs dfs -ls /user/$USER\n\n\n","user":"bd01","dateUpdated":"2021-02-04T13:31:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612440623508_769971792","id":"20210204-121023_149957682","dateCreated":"2021-02-04T12:10:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:815","dateFinished":"2021-02-04T13:28:07+0000","dateStarted":"2021-02-04T13:28:02+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"----create-DIR----\n----before-curl---\ntotal 925M\n-rw-r--r-- 1 zeppelin hadoop  58M Feb  4 12:35 household_data_15min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop 851M Feb  3 17:57 household_data_1min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop  15M Feb  4 12:33 household_data_60min_singleindex.csv\n----after-curl----\ntotal 925M\n-rw-r--r-- 1 zeppelin hadoop  58M Feb  4 12:35 household_data_15min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop 851M Feb  3 17:57 household_data_1min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop  15M Feb  4 12:33 household_data_60min_singleindex.csv\n----hdfs----\nFound 8 items\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-01 12:12 /user/zeppelin/.sparkStaging\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-02 09:18 /user/zeppelin/bank2\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-04 12:57 /user/zeppelin/conf\n-rw-r--r--   1 zeppelin hdfs  892027611 2021-02-03 14:52 /user/zeppelin/household_data_1min_singleindex.csv\n-rw-r--r--   1 zeppelin hdfs   15654559 2021-02-04 13:22 /user/zeppelin/household_data_60min_singleindex.csv\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-04 10:30 /user/zeppelin/notebook\ndrwxr-xr-x   - zeppelin hdfs          0 2021-01-28 11:18 /user/zeppelin/test\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-03 18:01 /user/zeppelin/zeppelin\n"}]}},{"text":"%md\n## Work with Spark DF\n","user":"bd01","dateUpdated":"2021-02-04T13:56:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false,"completionKey":"TAB"},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612446944282_1625782149","id":"20210204-135544_129249179","dateCreated":"2021-02-04T13:55:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4386","dateFinished":"2021-02-04T13:56:05+0000","dateStarted":"2021-02-04T13:56:05+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Work with Spark DF</h2>\n</div>"}]}},{"text":"%spark2.pyspark\nprint(sc.version)\nprint(sc.pythonVer)\nprint(sc.master)\n","user":"bd01","dateUpdated":"2021-02-04T13:42:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612446115867_-1784103428","id":"20210204-134155_1021688883","dateCreated":"2021-02-04T13:41:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3245","dateFinished":"2021-02-04T13:42:25+0000","dateStarted":"2021-02-04T13:42:25+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2.3.2.3.1.0.0-78\n3.6\nyarn\n"}]}},{"text":"%spark2.pyspark\nimport os\npath = '/home/zeppelin/project'\n# file = 'household_data_1min_singleindex.csv'        #  1min granularity    # data for project\n# file='household_data_15min_singleindex.csv'       # 15min granularity    # data for second prototype\nfile = 'household_data_60min_singleindex.csv'       # 60min granualrity    # data for prototypeos.chdir(path)\n\npathfile = 'hdfs:///user/{}/{}'.format(os.getenv(\"USER\"),file)\ndf = spark.read.csv(pathfile, header=True, inferSchema=False, sep=\",\")\n","user":"bd01","dateUpdated":"2021-02-04T13:40:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612440627665_-1015050105","id":"20210204-121027_1126578232","dateCreated":"2021-02-04T12:10:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:887","dateFinished":"2021-02-04T13:40:11+0000","dateStarted":"2021-02-04T13:40:11+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=64"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\n","user":"bd01","dateUpdated":"2021-02-04T13:48:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612446520299_170117221","id":"20210204-134840_366458471","dateCreated":"2021-02-04T13:48:40+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3536"},{"text":"%spark2.pyspark\n# df.show(4) # file has to many columns and is not readable with .show()\ndf.printSchema()","user":"bd01","dateUpdated":"2021-02-04T13:49:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612441110756_1093221361","id":"20210204-121830_1414895971","dateCreated":"2021-02-04T12:18:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:976","dateFinished":"2021-02-04T13:49:30+0000","dateStarted":"2021-02-04T13:49:30+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- utc_timestamp: string (nullable = true)\n |-- cet_cest_timestamp: string (nullable = true)\n |-- DE_KN_industrial1_grid_import: string (nullable = true)\n |-- DE_KN_industrial1_pv_1: string (nullable = true)\n |-- DE_KN_industrial1_pv_2: string (nullable = true)\n |-- DE_KN_industrial2_grid_import: string (nullable = true)\n |-- DE_KN_industrial2_pv: string (nullable = true)\n |-- DE_KN_industrial2_storage_charge: string (nullable = true)\n |-- DE_KN_industrial2_storage_decharge: string (nullable = true)\n |-- DE_KN_industrial3_area_offices: string (nullable = true)\n |-- DE_KN_industrial3_area_room_1: string (nullable = true)\n |-- DE_KN_industrial3_area_room_2: string (nullable = true)\n |-- DE_KN_industrial3_area_room_3: string (nullable = true)\n |-- DE_KN_industrial3_area_room_4: string (nullable = true)\n |-- DE_KN_industrial3_compressor: string (nullable = true)\n |-- DE_KN_industrial3_cooling_aggregate: string (nullable = true)\n |-- DE_KN_industrial3_cooling_pumps: string (nullable = true)\n |-- DE_KN_industrial3_dishwasher: string (nullable = true)\n |-- DE_KN_industrial3_ev: string (nullable = true)\n |-- DE_KN_industrial3_grid_import: string (nullable = true)\n |-- DE_KN_industrial3_machine_1: string (nullable = true)\n |-- DE_KN_industrial3_machine_2: string (nullable = true)\n |-- DE_KN_industrial3_machine_3: string (nullable = true)\n |-- DE_KN_industrial3_machine_4: string (nullable = true)\n |-- DE_KN_industrial3_machine_5: string (nullable = true)\n |-- DE_KN_industrial3_pv_facade: string (nullable = true)\n |-- DE_KN_industrial3_pv_roof: string (nullable = true)\n |-- DE_KN_industrial3_refrigerator: string (nullable = true)\n |-- DE_KN_industrial3_ventilation: string (nullable = true)\n |-- DE_KN_public1_grid_import: string (nullable = true)\n |-- DE_KN_public2_grid_import: string (nullable = true)\n |-- DE_KN_residential1_dishwasher: string (nullable = true)\n |-- DE_KN_residential1_freezer: string (nullable = true)\n |-- DE_KN_residential1_grid_import: string (nullable = true)\n |-- DE_KN_residential1_heat_pump: string (nullable = true)\n |-- DE_KN_residential1_pv: string (nullable = true)\n |-- DE_KN_residential1_washing_machine: string (nullable = true)\n |-- DE_KN_residential2_circulation_pump: string (nullable = true)\n |-- DE_KN_residential2_dishwasher: string (nullable = true)\n |-- DE_KN_residential2_freezer: string (nullable = true)\n |-- DE_KN_residential2_grid_import: string (nullable = true)\n |-- DE_KN_residential2_washing_machine: string (nullable = true)\n |-- DE_KN_residential3_circulation_pump: string (nullable = true)\n |-- DE_KN_residential3_dishwasher: string (nullable = true)\n |-- DE_KN_residential3_freezer: string (nullable = true)\n |-- DE_KN_residential3_grid_export: string (nullable = true)\n |-- DE_KN_residential3_grid_import: string (nullable = true)\n |-- DE_KN_residential3_pv: string (nullable = true)\n |-- DE_KN_residential3_refrigerator: string (nullable = true)\n |-- DE_KN_residential3_washing_machine: string (nullable = true)\n |-- DE_KN_residential4_dishwasher: string (nullable = true)\n |-- DE_KN_residential4_ev: string (nullable = true)\n |-- DE_KN_residential4_freezer: string (nullable = true)\n |-- DE_KN_residential4_grid_export: string (nullable = true)\n |-- DE_KN_residential4_grid_import: string (nullable = true)\n |-- DE_KN_residential4_heat_pump: string (nullable = true)\n |-- DE_KN_residential4_pv: string (nullable = true)\n |-- DE_KN_residential4_refrigerator: string (nullable = true)\n |-- DE_KN_residential4_washing_machine: string (nullable = true)\n |-- DE_KN_residential5_dishwasher: string (nullable = true)\n |-- DE_KN_residential5_grid_import: string (nullable = true)\n |-- DE_KN_residential5_refrigerator: string (nullable = true)\n |-- DE_KN_residential5_washing_machine: string (nullable = true)\n |-- DE_KN_residential6_circulation_pump: string (nullable = true)\n |-- DE_KN_residential6_dishwasher: string (nullable = true)\n |-- DE_KN_residential6_freezer: string (nullable = true)\n |-- DE_KN_residential6_grid_export: string (nullable = true)\n |-- DE_KN_residential6_grid_import: string (nullable = true)\n |-- DE_KN_residential6_pv: string (nullable = true)\n |-- DE_KN_residential6_washing_machine: string (nullable = true)\n |-- interpolated: string (nullable = true)\n\n"}]}},{"text":"%spark2.pyspark\ndf.printSchema()","user":"bd01","dateUpdated":"2021-02-04T13:49:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612445870499_-1002688052","id":"20210204-133750_1506957959","dateCreated":"2021-02-04T13:37:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2906","dateFinished":"2021-02-04T13:46:45+0000","dateStarted":"2021-02-04T13:46:45+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- utc_timestamp: string (nullable = true)\n |-- cet_cest_timestamp: string (nullable = true)\n |-- DE_KN_industrial1_grid_import: string (nullable = true)\n |-- DE_KN_industrial1_pv_1: string (nullable = true)\n |-- DE_KN_industrial1_pv_2: string (nullable = true)\n |-- DE_KN_industrial2_grid_import: string (nullable = true)\n |-- DE_KN_industrial2_pv: string (nullable = true)\n |-- DE_KN_industrial2_storage_charge: string (nullable = true)\n |-- DE_KN_industrial2_storage_decharge: string (nullable = true)\n |-- DE_KN_industrial3_area_offices: string (nullable = true)\n |-- DE_KN_industrial3_area_room_1: string (nullable = true)\n |-- DE_KN_industrial3_area_room_2: string (nullable = true)\n |-- DE_KN_industrial3_area_room_3: string (nullable = true)\n |-- DE_KN_industrial3_area_room_4: string (nullable = true)\n |-- DE_KN_industrial3_compressor: string (nullable = true)\n |-- DE_KN_industrial3_cooling_aggregate: string (nullable = true)\n |-- DE_KN_industrial3_cooling_pumps: string (nullable = true)\n |-- DE_KN_industrial3_dishwasher: string (nullable = true)\n |-- DE_KN_industrial3_ev: string (nullable = true)\n |-- DE_KN_industrial3_grid_import: string (nullable = true)\n |-- DE_KN_industrial3_machine_1: string (nullable = true)\n |-- DE_KN_industrial3_machine_2: string (nullable = true)\n |-- DE_KN_industrial3_machine_3: string (nullable = true)\n |-- DE_KN_industrial3_machine_4: string (nullable = true)\n |-- DE_KN_industrial3_machine_5: string (nullable = true)\n |-- DE_KN_industrial3_pv_facade: string (nullable = true)\n |-- DE_KN_industrial3_pv_roof: string (nullable = true)\n |-- DE_KN_industrial3_refrigerator: string (nullable = true)\n |-- DE_KN_industrial3_ventilation: string (nullable = true)\n |-- DE_KN_public1_grid_import: string (nullable = true)\n |-- DE_KN_public2_grid_import: string (nullable = true)\n |-- DE_KN_residential1_dishwasher: string (nullable = true)\n |-- DE_KN_residential1_freezer: string (nullable = true)\n |-- DE_KN_residential1_grid_import: string (nullable = true)\n |-- DE_KN_residential1_heat_pump: string (nullable = true)\n |-- DE_KN_residential1_pv: string (nullable = true)\n |-- DE_KN_residential1_washing_machine: string (nullable = true)\n |-- DE_KN_residential2_circulation_pump: string (nullable = true)\n |-- DE_KN_residential2_dishwasher: string (nullable = true)\n |-- DE_KN_residential2_freezer: string (nullable = true)\n |-- DE_KN_residential2_grid_import: string (nullable = true)\n |-- DE_KN_residential2_washing_machine: string (nullable = true)\n |-- DE_KN_residential3_circulation_pump: string (nullable = true)\n |-- DE_KN_residential3_dishwasher: string (nullable = true)\n |-- DE_KN_residential3_freezer: string (nullable = true)\n |-- DE_KN_residential3_grid_export: string (nullable = true)\n |-- DE_KN_residential3_grid_import: string (nullable = true)\n |-- DE_KN_residential3_pv: string (nullable = true)\n |-- DE_KN_residential3_refrigerator: string (nullable = true)\n |-- DE_KN_residential3_washing_machine: string (nullable = true)\n |-- DE_KN_residential4_dishwasher: string (nullable = true)\n |-- DE_KN_residential4_ev: string (nullable = true)\n |-- DE_KN_residential4_freezer: string (nullable = true)\n |-- DE_KN_residential4_grid_export: string (nullable = true)\n |-- DE_KN_residential4_grid_import: string (nullable = true)\n |-- DE_KN_residential4_heat_pump: string (nullable = true)\n |-- DE_KN_residential4_pv: string (nullable = true)\n |-- DE_KN_residential4_refrigerator: string (nullable = true)\n |-- DE_KN_residential4_washing_machine: string (nullable = true)\n |-- DE_KN_residential5_dishwasher: string (nullable = true)\n |-- DE_KN_residential5_grid_import: string (nullable = true)\n |-- DE_KN_residential5_refrigerator: string (nullable = true)\n |-- DE_KN_residential5_washing_machine: string (nullable = true)\n |-- DE_KN_residential6_circulation_pump: string (nullable = true)\n |-- DE_KN_residential6_dishwasher: string (nullable = true)\n |-- DE_KN_residential6_freezer: string (nullable = true)\n |-- DE_KN_residential6_grid_export: string (nullable = true)\n |-- DE_KN_residential6_grid_import: string (nullable = true)\n |-- DE_KN_residential6_pv: string (nullable = true)\n |-- DE_KN_residential6_washing_machine: string (nullable = true)\n |-- interpolated: string (nullable = true)\n\n"}]}},{"text":"%spark2.pyspark\n","user":"bd01","dateUpdated":"2021-02-04T13:45:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612446356297_-594161915","id":"20210204-134556_1918699090","dateCreated":"2021-02-04T13:45:56+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3366"}],"name":"MEP / wdgubser / 500 Prototype 1","id":"2FX9Q8A1U","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"shUser:bd01:":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}