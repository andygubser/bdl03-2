{"paragraphs":[{"text":"%md\n# Prototype 1","user":"bd01","dateUpdated":"2021-02-04T10:29:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Prototype 1</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1612434548091_398048288","id":"20210127-071031_1944670894","dateCreated":"2021-02-04T10:29:08+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9170"},{"text":"%md\n## Settings\n* Review active interpreters: md (needs to be on the top), spark2, sh, shUser\n* Review correct file to analyse in %sh and %spark2.pyspark\n","user":"bd01","dateUpdated":"2021-02-04T12:57:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Settings</h2>\n<ul>\n  <li>Review active interpreters: md (needs to be on the top), spark2, sh, shUser</li>\n  <li>Review correct file to analyse in %sh and %spark2.pyspark</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1612442873827_1475982537","id":"20210204-124753_933285857","dateCreated":"2021-02-04T12:47:53+0000","dateStarted":"2021-02-04T12:57:50+0000","dateFinished":"2021-02-04T12:57:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9171"},{"text":"%md\n## Bring the data to the GW","user":"bd01","dateUpdated":"2021-02-04T12:46:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Bring the data to the GW</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1612442773454_-1299160623","id":"20210204-124613_558847832","dateCreated":"2021-02-04T12:46:13+0000","dateStarted":"2021-02-04T12:46:40+0000","dateFinished":"2021-02-04T12:46:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9172"},{"text":"%sh\nDIR=/home/zeppelin/project\n\nBASE_URL=\"https://data.open-power-system-data.org/household_data/2020-04-15/\"\n\n# blocksize (HDFS) is 8 MB\n# FILE='household_data_1min_singleindex.csv'        #  1min granularity    # data for project\n# FILE='household_data_15min_singleindex.csv'       # 15min granularity    # data for second prototype\nFILE='household_data_60min_singleindex.csv'       # 60min granualrity    # data for prototype\n\nURL=$BASE_URL/$FILE\n\n# download into the GW - but just once\n\necho \"----create-DIR----\"\ntest -d $DIR || mkdir $DIR\n\necho \"----before-curl---\"\nls -lh $DIR\n\necho \"----after-curl----\"\ntest -f $DIR/$FILE || curl -sSlO $URL\nls -lh $DIR\n\necho \"----hdfs----\"\nhdfs dfs -test -f $FILE      || hdfs dfs -put $DIR/$FILE .\nhdfs dfs -ls /user/$USER\n\n\n","user":"bd01","dateUpdated":"2021-02-04T13:31:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"----create-DIR----\n----before-curl---\ntotal 925M\n-rw-r--r-- 1 zeppelin hadoop  58M Feb  4 12:35 household_data_15min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop 851M Feb  3 17:57 household_data_1min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop  15M Feb  4 12:33 household_data_60min_singleindex.csv\n----after-curl----\ntotal 925M\n-rw-r--r-- 1 zeppelin hadoop  58M Feb  4 12:35 household_data_15min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop 851M Feb  3 17:57 household_data_1min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop  15M Feb  4 12:33 household_data_60min_singleindex.csv\n----hdfs----\nFound 8 items\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-01 12:12 /user/zeppelin/.sparkStaging\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-02 09:18 /user/zeppelin/bank2\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-04 12:57 /user/zeppelin/conf\n-rw-r--r--   1 zeppelin hdfs  892027611 2021-02-03 14:52 /user/zeppelin/household_data_1min_singleindex.csv\n-rw-r--r--   1 zeppelin hdfs   15654559 2021-02-04 13:22 /user/zeppelin/household_data_60min_singleindex.csv\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-04 10:30 /user/zeppelin/notebook\ndrwxr-xr-x   - zeppelin hdfs          0 2021-01-28 11:18 /user/zeppelin/test\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-03 18:01 /user/zeppelin/zeppelin\n"}]},"apps":[],"jobName":"paragraph_1612440623508_769971792","id":"20210204-121023_149957682","dateCreated":"2021-02-04T12:10:23+0000","dateStarted":"2021-02-04T13:28:02+0000","dateFinished":"2021-02-04T13:28:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9173"},{"text":"%md\n## Work with Spark DF\n","user":"bd01","dateUpdated":"2021-02-04T13:56:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false,"completionKey":"TAB"},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Work with Spark DF</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1612446944282_1625782149","id":"20210204-135544_129249179","dateCreated":"2021-02-04T13:55:44+0000","dateStarted":"2021-02-04T13:56:05+0000","dateFinished":"2021-02-04T13:56:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9174"},{"text":"%spark2.pyspark\nprint(sc.version)\nprint(sc.pythonVer)\nprint(sc.master)\n","user":"bd01","dateUpdated":"2021-02-04T13:42:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2.3.2.3.1.0.0-78\n3.6\nyarn\n"}]},"apps":[],"jobName":"paragraph_1612446115867_-1784103428","id":"20210204-134155_1021688883","dateCreated":"2021-02-04T13:41:55+0000","dateStarted":"2021-02-04T13:42:25+0000","dateFinished":"2021-02-04T13:42:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9175"},{"text":"%spark2.pyspark\nimport os\npath = '/home/zeppelin/project'\n# file = 'household_data_1min_singleindex.csv'        #  1min granularity    # data for project\n# file='household_data_15min_singleindex.csv'       # 15min granularity    # data for second prototype\nfile = 'household_data_60min_singleindex.csv'       # 60min granualrity    # data for prototypeos.chdir(path)\n\npathfile = 'hdfs:///user/{}/{}'.format(os.getenv(\"USER\"),file)\ndf = spark.read.csv(pathfile, header=True, inferSchema=False, sep=\",\")\n","user":"bd01","dateUpdated":"2021-02-04T13:40:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=64"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1612440627665_-1015050105","id":"20210204-121027_1126578232","dateCreated":"2021-02-04T12:10:27+0000","dateStarted":"2021-02-04T13:40:11+0000","dateFinished":"2021-02-04T13:40:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9176"},{"text":"%spark2.pyspark\n#df.show(4) # file has to many columns and is not readable with .show()\n#df.schema.names\ndf.printSchema()","user":"bd01","dateUpdated":"2021-02-04T14:17:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- utc_timestamp: string (nullable = true)\n |-- cet_cest_timestamp: string (nullable = true)\n |-- DE_KN_industrial1_grid_import: string (nullable = true)\n |-- DE_KN_industrial1_pv_1: string (nullable = true)\n |-- DE_KN_industrial1_pv_2: string (nullable = true)\n |-- DE_KN_industrial2_grid_import: string (nullable = true)\n |-- DE_KN_industrial2_pv: string (nullable = true)\n |-- DE_KN_industrial2_storage_charge: string (nullable = true)\n |-- DE_KN_industrial2_storage_decharge: string (nullable = true)\n |-- DE_KN_industrial3_area_offices: string (nullable = true)\n |-- DE_KN_industrial3_area_room_1: string (nullable = true)\n |-- DE_KN_industrial3_area_room_2: string (nullable = true)\n |-- DE_KN_industrial3_area_room_3: string (nullable = true)\n |-- DE_KN_industrial3_area_room_4: string (nullable = true)\n |-- DE_KN_industrial3_compressor: string (nullable = true)\n |-- DE_KN_industrial3_cooling_aggregate: string (nullable = true)\n |-- DE_KN_industrial3_cooling_pumps: string (nullable = true)\n |-- DE_KN_industrial3_dishwasher: string (nullable = true)\n |-- DE_KN_industrial3_ev: string (nullable = true)\n |-- DE_KN_industrial3_grid_import: string (nullable = true)\n |-- DE_KN_industrial3_machine_1: string (nullable = true)\n |-- DE_KN_industrial3_machine_2: string (nullable = true)\n |-- DE_KN_industrial3_machine_3: string (nullable = true)\n |-- DE_KN_industrial3_machine_4: string (nullable = true)\n |-- DE_KN_industrial3_machine_5: string (nullable = true)\n |-- DE_KN_industrial3_pv_facade: string (nullable = true)\n |-- DE_KN_industrial3_pv_roof: string (nullable = true)\n |-- DE_KN_industrial3_refrigerator: string (nullable = true)\n |-- DE_KN_industrial3_ventilation: string (nullable = true)\n |-- DE_KN_public1_grid_import: string (nullable = true)\n |-- DE_KN_public2_grid_import: string (nullable = true)\n |-- DE_KN_residential1_dishwasher: string (nullable = true)\n |-- DE_KN_residential1_freezer: string (nullable = true)\n |-- DE_KN_residential1_grid_import: string (nullable = true)\n |-- DE_KN_residential1_heat_pump: string (nullable = true)\n |-- DE_KN_residential1_pv: string (nullable = true)\n |-- DE_KN_residential1_washing_machine: string (nullable = true)\n |-- DE_KN_residential2_circulation_pump: string (nullable = true)\n |-- DE_KN_residential2_dishwasher: string (nullable = true)\n |-- DE_KN_residential2_freezer: string (nullable = true)\n |-- DE_KN_residential2_grid_import: string (nullable = true)\n |-- DE_KN_residential2_washing_machine: string (nullable = true)\n |-- DE_KN_residential3_circulation_pump: string (nullable = true)\n |-- DE_KN_residential3_dishwasher: string (nullable = true)\n |-- DE_KN_residential3_freezer: string (nullable = true)\n |-- DE_KN_residential3_grid_export: string (nullable = true)\n |-- DE_KN_residential3_grid_import: string (nullable = true)\n |-- DE_KN_residential3_pv: string (nullable = true)\n |-- DE_KN_residential3_refrigerator: string (nullable = true)\n |-- DE_KN_residential3_washing_machine: string (nullable = true)\n |-- DE_KN_residential4_dishwasher: string (nullable = true)\n |-- DE_KN_residential4_ev: string (nullable = true)\n |-- DE_KN_residential4_freezer: string (nullable = true)\n |-- DE_KN_residential4_grid_export: string (nullable = true)\n |-- DE_KN_residential4_grid_import: string (nullable = true)\n |-- DE_KN_residential4_heat_pump: string (nullable = true)\n |-- DE_KN_residential4_pv: string (nullable = true)\n |-- DE_KN_residential4_refrigerator: string (nullable = true)\n |-- DE_KN_residential4_washing_machine: string (nullable = true)\n |-- DE_KN_residential5_dishwasher: string (nullable = true)\n |-- DE_KN_residential5_grid_import: string (nullable = true)\n |-- DE_KN_residential5_refrigerator: string (nullable = true)\n |-- DE_KN_residential5_washing_machine: string (nullable = true)\n |-- DE_KN_residential6_circulation_pump: string (nullable = true)\n |-- DE_KN_residential6_dishwasher: string (nullable = true)\n |-- DE_KN_residential6_freezer: string (nullable = true)\n |-- DE_KN_residential6_grid_export: string (nullable = true)\n |-- DE_KN_residential6_grid_import: string (nullable = true)\n |-- DE_KN_residential6_pv: string (nullable = true)\n |-- DE_KN_residential6_washing_machine: string (nullable = true)\n |-- interpolated: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1612441110756_1093221361","id":"20210204-121830_1414895971","dateCreated":"2021-02-04T12:18:30+0000","dateStarted":"2021-02-04T14:17:24+0000","dateFinished":"2021-02-04T14:17:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9177"},{"text":"%md\nI want to split the df into one df for industrial, one df for public, and one df for residential units. \nFurther, I want to transform from the wide format to a long format. I create an additional column indicating the number of the unit. \n\ndf_residential\n\n|unit             |dishwasher       |freezer          |grid_import      |heat_pump        |pv               | washing_maschine|\n|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|\n|                 |                 |                 |                 |                 |                 |                 |","user":"bd01","dateUpdated":"2021-02-04T16:24:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>I want to split the df into one df for industrial, one df for public, and one df for residential units.<br/>Further, I want to transform from the wide format to a long format. I create an additional column indicating the number of the unit. </p>\n<p>df_residential</p>\n<table>\n  <thead>\n    <tr>\n      <th>unit </th>\n      <th>dishwasher </th>\n      <th>freezer </th>\n      <th>grid_import </th>\n      <th>heat_pump </th>\n      <th>pv </th>\n      <th>washing_maschine</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n    </tr>\n  </tbody>\n</table>\n</div>"}]},"apps":[],"jobName":"paragraph_1612447061642_-302177401","id":"20210204-135741_172296699","dateCreated":"2021-02-04T13:57:41+0000","dateStarted":"2021-02-04T16:24:45+0000","dateFinished":"2021-02-04T16:24:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9178"},{"text":"%spark2.pyspark\n\n# Split the df\n\nimport re\n\ncols = df.schema.names\n\n# split\ndef get_categorical_colnames(cols, category_string, num):\n    cols_additional = [\"utc_timestamp\" , \"cet_cest_timestamp\", \"interpolated\"]\n    cols_category = [el for el in cols if f\"{category_string}{num}\" in el]\n    return cols_additional + cols_category\n\ndf_clean = df.select(get_categorical_colnames(cols, \"residential\"))\n\n","user":"bd01","dateUpdated":"2021-02-04T16:39:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 13: df_clean = df.select(get_categorical_colnames(cols, \"residential\"))\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-5406178559337363436.py\", line 380, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 13, in <module>\nTypeError: get_categorical_colnames() missing 1 required positional argument: 'num'\n"}]},"apps":[],"jobName":"paragraph_1612445870499_-1002688052","id":"20210204-133750_1506957959","dateCreated":"2021-02-04T13:37:50+0000","dateStarted":"2021-02-04T16:39:33+0000","dateFinished":"2021-02-04T16:39:33+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:9179"},{"text":"%spark2.pyspark\n# finish\ndef get_clean_colnames(cols, category_string, num):\n    cols_additional = [\"utc_timestamp\" , \"cet_cest_timestamp\", \"interpolated\"]\n    cols_category = get_categorical_colnames(cols, category_string, num)\n    cols_clean = [re.sub(f'DE\\_KN\\_{category_string}\\d_', '', el) for el in cols_category]\n    return set(cols_additional + cols_clean) \n\n\ncols_residential_1 = get_clean_colnames(cols, \"residential\", num=1) \ncols_residential_2 = get_clean_colnames(cols, \"residential\", num=2) \ncols_residential_3 = get_clean_colnames(cols, \"residential\", num=3) \ncols_residential_4 = get_clean_colnames(cols, \"residential\", num=4) \ncols_residential_5 = get_clean_colnames(cols, \"residential\", num=5) \ncols_residential_6 = get_clean_colnames(cols, \"residential\", num=6) \n\n#cols_industrial  = get_categorical_colnames(cols, \"industrial\")\n#cols_public      = get_categorical_colnames(cols, \"public\")\n\n#cols_residential_clean = get_categorical_colnames(cols, \"residential\")\n#cols_industrial_clean  = get_categorical_colnames(cols, \"industrial\")\n#cols_public_clean      = get_categorical_colnames(cols, \"public\")\n\n#df_residential = df.select(cols_residential)\n#df_industrial = df.select(cols_industrial)\n#df_public = df.select(cols_public)\n\nprint(cols_residential_1)\n","user":"bd01","dateUpdated":"2021-02-04T16:39:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612456759351_-1546741719","id":"20210204-163919_1469595692","dateCreated":"2021-02-04T16:39:19+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11008"},{"text":"%spark2.pyspark\ndf_residential1.select()","user":"bd01","dateUpdated":"2021-02-04T16:31:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+-----------------------------+--------------------------+------------------------------+----------------------------+---------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+---------------------+--------------------------+------------------------------+------------------------------+----------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+------------------------------+-------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+----------------------------------+\n|       utc_timestamp|  cet_cest_timestamp|        interpolated|DE_KN_residential1_dishwasher|DE_KN_residential1_freezer|DE_KN_residential1_grid_import|DE_KN_residential1_heat_pump|DE_KN_residential1_pv|DE_KN_residential1_washing_machine|DE_KN_residential2_circulation_pump|DE_KN_residential2_dishwasher|DE_KN_residential2_freezer|DE_KN_residential2_grid_import|DE_KN_residential2_washing_machine|DE_KN_residential3_circulation_pump|DE_KN_residential3_dishwasher|DE_KN_residential3_freezer|DE_KN_residential3_grid_export|DE_KN_residential3_grid_import|DE_KN_residential3_pv|DE_KN_residential3_refrigerator|DE_KN_residential3_washing_machine|DE_KN_residential4_dishwasher|DE_KN_residential4_ev|DE_KN_residential4_freezer|DE_KN_residential4_grid_export|DE_KN_residential4_grid_import|DE_KN_residential4_heat_pump|DE_KN_residential4_pv|DE_KN_residential4_refrigerator|DE_KN_residential4_washing_machine|DE_KN_residential5_dishwasher|DE_KN_residential5_grid_import|DE_KN_residential5_refrigerator|DE_KN_residential5_washing_machine|DE_KN_residential6_circulation_pump|DE_KN_residential6_dishwasher|DE_KN_residential6_freezer|DE_KN_residential6_grid_export|DE_KN_residential6_grid_import|DE_KN_residential6_pv|DE_KN_residential6_washing_machine|\n+--------------------+--------------------+--------------------+-----------------------------+--------------------------+------------------------------+----------------------------+---------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+---------------------+--------------------------+------------------------------+------------------------------+----------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+------------------------------+-------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+----------------------------------+\n|2014-12-11T17:00:00Z|2014-12-11T18:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                               null|                        0.000|                     0.002|                          null|                          null|                 null|                           null|                              null|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T18:00:00Z|2014-12-11T19:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.063|                        0.003|                     0.024|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T19:00:00Z|2014-12-11T20:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.132|                        0.005|                     0.064|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T20:00:00Z|2014-12-11T21:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.200|                        0.008|                     0.102|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T21:00:00Z|2014-12-11T22:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.269|                        0.010|                     0.106|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T22:00:00Z|2014-12-11T23:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.310|                        0.013|                     0.146|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T23:00:00Z|2014-12-12T00:00:...|DE_KN_residential...|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.369|                        0.016|                     0.185|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T00:00:00Z|2014-12-12T01:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.440|                        0.018|                     0.201|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T01:00:00Z|2014-12-12T02:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.507|                        0.021|                     0.228|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T02:00:00Z|2014-12-12T03:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.579|                        0.023|                     0.268|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T03:00:00Z|2014-12-12T04:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.647|                        0.026|                     0.300|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T04:00:00Z|2014-12-12T05:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.717|                        0.028|                     0.309|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T05:00:00Z|2014-12-12T06:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.789|                        0.031|                     0.349|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T06:00:00Z|2014-12-12T07:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.857|                        0.079|                     0.388|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T07:00:00Z|2014-12-12T08:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.932|                        1.293|                     0.394|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T08:00:00Z|2014-12-12T09:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.020|                        1.298|                     0.430|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T09:00:00Z|2014-12-12T10:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.139|                        1.300|                     0.469|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T10:00:00Z|2014-12-12T11:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.257|                        1.303|                     0.491|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T11:00:00Z|2014-12-12T12:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.368|                        1.305|                     0.510|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T12:00:00Z|2014-12-12T13:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.470|                        1.308|                     0.550|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n+--------------------+--------------------+--------------------+-----------------------------+--------------------------+------------------------------+----------------------------+---------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+---------------------+--------------------------+------------------------------+------------------------------+----------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+------------------------------+-------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+----------------------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=75"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1612446356297_-594161915","id":"20210204-134556_1918699090","dateCreated":"2021-02-04T13:45:56+0000","dateStarted":"2021-02-04T16:28:52+0000","dateFinished":"2021-02-04T16:28:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9181"},{"text":"%spark2.pyspark\ndf_residential.select(\"DE_KN_residential1_dishwasher\").describe()","user":"bd01","dateUpdated":"2021-02-04T16:20:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612452643541_2054737280","id":"20210204-153043_1199079094","dateCreated":"2021-02-04T15:30:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9182","dateFinished":"2021-02-04T16:20:41+0000","dateStarted":"2021-02-04T16:20:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[summary: string, DE_KN_residential1_dishwasher: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=74"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\ncols_industrial  = get_categorical_colnames(cols, \"industrial\")\n","user":"bd01","dateUpdated":"2021-02-04T16:13:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612455205971_-1053432588","id":"20210204-161325_1760667568","dateCreated":"2021-02-04T16:13:25+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10464"}],"name":"MEP / wdgubser / 500 Prototype 1","id":"2FX9Q8A1U","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"shUser:bd01:":[],"sh:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}