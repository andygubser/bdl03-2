{"paragraphs":[{"text":"%md\n# Prototype 1","user":"bd01","dateUpdated":"2021-02-04T17:00:50+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Prototype 1</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1612434548091_398048288","id":"20210127-071031_1944670894","dateCreated":"2021-02-04T10:29:08+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9170"},{"text":"%md\n## Settings\n* Review active interpreters: md (needs to be on the top), spark2, sh, shUser\n* Review correct file to analyse in %sh and %spark2.pyspark\n","user":"bd01","dateUpdated":"2021-02-04T17:00:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Settings</h2>\n<ul>\n  <li>Review active interpreters: md (needs to be on the top), spark2, sh, shUser</li>\n  <li>Review correct file to analyse in %sh and %spark2.pyspark</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1612442873827_1475982537","id":"20210204-124753_933285857","dateCreated":"2021-02-04T12:47:53+0000","dateStarted":"2021-02-04T12:57:50+0000","dateFinished":"2021-02-04T12:57:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9171"},{"text":"%md\n## Bring the data to the GW","user":"bd01","dateUpdated":"2021-02-04T17:00:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Bring the data to the GW</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1612442773454_-1299160623","id":"20210204-124613_558847832","dateCreated":"2021-02-04T12:46:13+0000","dateStarted":"2021-02-04T12:46:40+0000","dateFinished":"2021-02-04T12:46:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9172"},{"text":"%sh\nDIR=/home/zeppelin/project\n\nBASE_URL=\"https://data.open-power-system-data.org/household_data/2020-04-15/\"\n\n# blocksize (HDFS) is 8 MB\n# FILE='household_data_1min_singleindex.csv'        #  1min granularity    # data for project\n# FILE='household_data_15min_singleindex.csv'       # 15min granularity    # data for second prototype\nFILE='household_data_60min_singleindex.csv'       # 60min granualrity    # data for prototype\n\nURL=$BASE_URL/$FILE\n\n# download into the GW - but just once\n\necho \"----create-DIR----\"\ntest -d $DIR || mkdir $DIR\n\necho \"----before-curl---\"\nls -lh $DIR\n\necho \"----after-curl----\"\ntest -f $DIR/$FILE || curl -sSlO $URL\nls -lh $DIR\n\necho \"----hdfs----\"\nhdfs dfs -test -f $FILE      || hdfs dfs -put $DIR/$FILE .\nhdfs dfs -ls /user/$USER\n\n\n","user":"bd01","dateUpdated":"2021-02-04T17:00:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"----create-DIR----\n----before-curl---\ntotal 925M\n-rw-r--r-- 1 zeppelin hadoop  58M Feb  4 12:35 household_data_15min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop 851M Feb  3 17:57 household_data_1min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop  15M Feb  4 12:33 household_data_60min_singleindex.csv\n----after-curl----\ntotal 925M\n-rw-r--r-- 1 zeppelin hadoop  58M Feb  4 12:35 household_data_15min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop 851M Feb  3 17:57 household_data_1min_singleindex.csv\n-rw-r--r-- 1 zeppelin hadoop  15M Feb  4 12:33 household_data_60min_singleindex.csv\n----hdfs----\nFound 8 items\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-01 12:12 /user/zeppelin/.sparkStaging\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-02 09:18 /user/zeppelin/bank2\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-04 12:57 /user/zeppelin/conf\n-rw-r--r--   1 zeppelin hdfs  892027611 2021-02-03 14:52 /user/zeppelin/household_data_1min_singleindex.csv\n-rw-r--r--   1 zeppelin hdfs   15654559 2021-02-04 13:22 /user/zeppelin/household_data_60min_singleindex.csv\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-04 10:30 /user/zeppelin/notebook\ndrwxr-xr-x   - zeppelin hdfs          0 2021-01-28 11:18 /user/zeppelin/test\ndrwxr-xr-x   - zeppelin hdfs          0 2021-02-03 18:01 /user/zeppelin/zeppelin\n"}]},"apps":[],"jobName":"paragraph_1612440623508_769971792","id":"20210204-121023_149957682","dateCreated":"2021-02-04T12:10:23+0000","dateStarted":"2021-02-04T13:28:02+0000","dateFinished":"2021-02-04T13:28:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9173"},{"text":"%md\n## Work with Spark DF\n","user":"bd01","dateUpdated":"2021-02-04T17:00:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false,"completionKey":"TAB"},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Work with Spark DF</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1612446944282_1625782149","id":"20210204-135544_129249179","dateCreated":"2021-02-04T13:55:44+0000","dateStarted":"2021-02-04T13:56:05+0000","dateFinished":"2021-02-04T13:56:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9174"},{"text":"%spark2.pyspark\nprint(sc.version)\nprint(sc.pythonVer)\nprint(sc.master)\n","user":"bd01","dateUpdated":"2021-02-04T17:00:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2.3.2.3.1.0.0-78\n3.6\nyarn\n"}]},"apps":[],"jobName":"paragraph_1612446115867_-1784103428","id":"20210204-134155_1021688883","dateCreated":"2021-02-04T13:41:55+0000","dateStarted":"2021-02-04T13:42:25+0000","dateFinished":"2021-02-04T13:42:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9175"},{"text":"%spark2.pyspark\nimport os\npath = '/home/zeppelin/project'\n# file = 'household_data_1min_singleindex.csv'        #  1min granularity    # data for project\n# file='household_data_15min_singleindex.csv'       # 15min granularity    # data for second prototype\nfile = 'household_data_60min_singleindex.csv'       # 60min granualrity    # data for prototypeos.chdir(path)\n\npathfile = 'hdfs:///user/{}/{}'.format(os.getenv(\"USER\"),file)\ndf_raw = spark.read.csv(pathfile, header=True, inferSchema=False, sep=\",\")\n","user":"bd01","dateUpdated":"2021-02-04T18:01:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=96"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1612440627665_-1015050105","id":"20210204-121027_1126578232","dateCreated":"2021-02-04T12:10:27+0000","dateStarted":"2021-02-04T18:01:05+0000","dateFinished":"2021-02-04T18:01:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9176"},{"text":"%spark2.pyspark\n#df.show(4) # file has to many columns and is not readable with .show()\n#df.schema.names\ndf_raw.printSchema()","user":"bd01","dateUpdated":"2021-02-04T18:01:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- utc_timestamp: string (nullable = true)\n |-- cet_cest_timestamp: string (nullable = true)\n |-- DE_KN_industrial1_grid_import: string (nullable = true)\n |-- DE_KN_industrial1_pv_1: string (nullable = true)\n |-- DE_KN_industrial1_pv_2: string (nullable = true)\n |-- DE_KN_industrial2_grid_import: string (nullable = true)\n |-- DE_KN_industrial2_pv: string (nullable = true)\n |-- DE_KN_industrial2_storage_charge: string (nullable = true)\n |-- DE_KN_industrial2_storage_decharge: string (nullable = true)\n |-- DE_KN_industrial3_area_offices: string (nullable = true)\n |-- DE_KN_industrial3_area_room_1: string (nullable = true)\n |-- DE_KN_industrial3_area_room_2: string (nullable = true)\n |-- DE_KN_industrial3_area_room_3: string (nullable = true)\n |-- DE_KN_industrial3_area_room_4: string (nullable = true)\n |-- DE_KN_industrial3_compressor: string (nullable = true)\n |-- DE_KN_industrial3_cooling_aggregate: string (nullable = true)\n |-- DE_KN_industrial3_cooling_pumps: string (nullable = true)\n |-- DE_KN_industrial3_dishwasher: string (nullable = true)\n |-- DE_KN_industrial3_ev: string (nullable = true)\n |-- DE_KN_industrial3_grid_import: string (nullable = true)\n |-- DE_KN_industrial3_machine_1: string (nullable = true)\n |-- DE_KN_industrial3_machine_2: string (nullable = true)\n |-- DE_KN_industrial3_machine_3: string (nullable = true)\n |-- DE_KN_industrial3_machine_4: string (nullable = true)\n |-- DE_KN_industrial3_machine_5: string (nullable = true)\n |-- DE_KN_industrial3_pv_facade: string (nullable = true)\n |-- DE_KN_industrial3_pv_roof: string (nullable = true)\n |-- DE_KN_industrial3_refrigerator: string (nullable = true)\n |-- DE_KN_industrial3_ventilation: string (nullable = true)\n |-- DE_KN_public1_grid_import: string (nullable = true)\n |-- DE_KN_public2_grid_import: string (nullable = true)\n |-- DE_KN_residential1_dishwasher: string (nullable = true)\n |-- DE_KN_residential1_freezer: string (nullable = true)\n |-- DE_KN_residential1_grid_import: string (nullable = true)\n |-- DE_KN_residential1_heat_pump: string (nullable = true)\n |-- DE_KN_residential1_pv: string (nullable = true)\n |-- DE_KN_residential1_washing_machine: string (nullable = true)\n |-- DE_KN_residential2_circulation_pump: string (nullable = true)\n |-- DE_KN_residential2_dishwasher: string (nullable = true)\n |-- DE_KN_residential2_freezer: string (nullable = true)\n |-- DE_KN_residential2_grid_import: string (nullable = true)\n |-- DE_KN_residential2_washing_machine: string (nullable = true)\n |-- DE_KN_residential3_circulation_pump: string (nullable = true)\n |-- DE_KN_residential3_dishwasher: string (nullable = true)\n |-- DE_KN_residential3_freezer: string (nullable = true)\n |-- DE_KN_residential3_grid_export: string (nullable = true)\n |-- DE_KN_residential3_grid_import: string (nullable = true)\n |-- DE_KN_residential3_pv: string (nullable = true)\n |-- DE_KN_residential3_refrigerator: string (nullable = true)\n |-- DE_KN_residential3_washing_machine: string (nullable = true)\n |-- DE_KN_residential4_dishwasher: string (nullable = true)\n |-- DE_KN_residential4_ev: string (nullable = true)\n |-- DE_KN_residential4_freezer: string (nullable = true)\n |-- DE_KN_residential4_grid_export: string (nullable = true)\n |-- DE_KN_residential4_grid_import: string (nullable = true)\n |-- DE_KN_residential4_heat_pump: string (nullable = true)\n |-- DE_KN_residential4_pv: string (nullable = true)\n |-- DE_KN_residential4_refrigerator: string (nullable = true)\n |-- DE_KN_residential4_washing_machine: string (nullable = true)\n |-- DE_KN_residential5_dishwasher: string (nullable = true)\n |-- DE_KN_residential5_grid_import: string (nullable = true)\n |-- DE_KN_residential5_refrigerator: string (nullable = true)\n |-- DE_KN_residential5_washing_machine: string (nullable = true)\n |-- DE_KN_residential6_circulation_pump: string (nullable = true)\n |-- DE_KN_residential6_dishwasher: string (nullable = true)\n |-- DE_KN_residential6_freezer: string (nullable = true)\n |-- DE_KN_residential6_grid_export: string (nullable = true)\n |-- DE_KN_residential6_grid_import: string (nullable = true)\n |-- DE_KN_residential6_pv: string (nullable = true)\n |-- DE_KN_residential6_washing_machine: string (nullable = true)\n |-- interpolated: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1612441110756_1093221361","id":"20210204-121830_1414895971","dateCreated":"2021-02-04T12:18:30+0000","dateStarted":"2021-02-04T18:01:08+0000","dateFinished":"2021-02-04T18:01:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9177"},{"text":"%md\n## \"ETL\"","user":"bd01","dateUpdated":"2021-02-04T18:00:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false,"completionKey":"TAB"},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612461603573_-1517850452","id":"20210204-180003_1669074929","dateCreated":"2021-02-04T18:00:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14564","dateFinished":"2021-02-04T18:00:15+0000","dateStarted":"2021-02-04T18:00:15+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>&ldquo;ETL&rdquo;</h2>\n</div>"}]}},{"text":"%md\nI want to split the df into one df for industrial, one df for public, and one df for residential units. \nFurther, I want to transform from the wide format to a long format. I create an additional column indicating the number of the unit. \n\ndf_residential\n\n|unit             |dishwasher       |freezer          |grid_import      |heat_pump        |pv               | washing_maschine|\n|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|\n|                 |                 |                 |                 |                 |                 |                 |","user":"bd01","dateUpdated":"2021-02-04T17:00:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>I want to split the df into one df for industrial, one df for public, and one df for residential units.<br/>Further, I want to transform from the wide format to a long format. I create an additional column indicating the number of the unit. </p>\n<p>df_residential</p>\n<table>\n  <thead>\n    <tr>\n      <th>unit </th>\n      <th>dishwasher </th>\n      <th>freezer </th>\n      <th>grid_import </th>\n      <th>heat_pump </th>\n      <th>pv </th>\n      <th>washing_maschine</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n      <td> </td>\n    </tr>\n  </tbody>\n</table>\n</div>"}]},"apps":[],"jobName":"paragraph_1612447061642_-302177401","id":"20210204-135741_172296699","dateCreated":"2021-02-04T13:57:41+0000","dateStarted":"2021-02-04T16:24:45+0000","dateFinished":"2021-02-04T16:24:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9178"},{"text":"%spark2.pyspark\n\n# functions\n# Split the df\n\nimport re\n\ndef get_cols_of_category(df, str_category):\n    ls_cols_all = df.schema.names\n    ls_cols_additional = [\"utc_timestamp\" , \"cet_cest_timestamp\", \"interpolated\"]\n    return [col for col in ls_cols_all if str_category in col]\nprint(get_cols_of_category(df=df, str_category=\"residential\"))\n    \ndef get_cols_of_category_cleaned(df, str_category):\n    ls_cols_of_category = get_cols_of_category(df, str_category)\n    ls_cols_additional = [\"utc_timestamp\" , \"cet_cest_timestamp\", \"interpolated\"]\n    return ls_cols_additional + list(set([re.sub(f'DE\\_KN\\_{str_category}\\d_', '', col) for col in ls_cols_of_category]))\nprint(get_cols_of_category_cleaned(df=df, str_category=\"residential\"))\n\ndef get_df_relevant(ls_cols, str_category, num):\n    cols_of_category = get_cols_of_category(ls_cols=ls_cols, \n                       str_category=\"residential\", \n                       num=num)\n    df_rel = df.select(cols_of_category).withColumn(\"unit\", lit(num))\n    \n    \n    \n    df_renamed = df_rel.withColumnRenamed(\n        f'DE_KN_residential{num}_pv', 'pv'\n        ).withColumnRenamed(\n            f'DE_KN_residential{num}_dishwasher', 'dishwasher'\n            ).withColumnRenamed(\n                f'DE_KN_residential{num}_washing_machine', 'washing_machine'\n                ).withColumnRenamed(\n                    f'DE_KN_residential{num}_heat_pump', 'heat_pump'\n                    ).withColumnRenamed(\n                        f'DE_KN_residential{num}_freezer', 'freezer'\n                        ).withColumnRenamed(\n                            f'DE_KN_residential{num}_grid_import', 'grid_import'\n                            ).withColumnRenamed(\n                                f'DE_KN_residential{num}_grid_export', 'grid_export'\n                                ).withColumnRenamed(\n                                f'DE_KN_residential{num}_circulation_pump', 'circulation_pump'\n                                ).withColumnRenamed(\n                                    f'DE_KN_residential{num}_refrigerator','refrigerator'\n                                    )\n    \n    return df_renamed\n\n    ","user":"bd01","dateUpdated":"2021-02-04T19:01:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['DE_KN_residential1_dishwasher', 'DE_KN_residential1_freezer', 'DE_KN_residential1_grid_import', 'DE_KN_residential1_heat_pump', 'DE_KN_residential1_pv', 'DE_KN_residential1_washing_machine', 'DE_KN_residential2_circulation_pump', 'DE_KN_residential2_dishwasher', 'DE_KN_residential2_freezer', 'DE_KN_residential2_grid_import', 'DE_KN_residential2_washing_machine', 'DE_KN_residential3_circulation_pump', 'DE_KN_residential3_dishwasher', 'DE_KN_residential3_freezer', 'DE_KN_residential3_grid_export', 'DE_KN_residential3_grid_import', 'DE_KN_residential3_pv', 'DE_KN_residential3_refrigerator', 'DE_KN_residential3_washing_machine', 'DE_KN_residential4_dishwasher', 'DE_KN_residential4_ev', 'DE_KN_residential4_freezer', 'DE_KN_residential4_grid_export', 'DE_KN_residential4_grid_import', 'DE_KN_residential4_heat_pump', 'DE_KN_residential4_pv', 'DE_KN_residential4_refrigerator', 'DE_KN_residential4_washing_machine', 'DE_KN_residential5_dishwasher', 'DE_KN_residential5_grid_import', 'DE_KN_residential5_refrigerator', 'DE_KN_residential5_washing_machine', 'DE_KN_residential6_circulation_pump', 'DE_KN_residential6_dishwasher', 'DE_KN_residential6_freezer', 'DE_KN_residential6_grid_export', 'DE_KN_residential6_grid_import', 'DE_KN_residential6_pv', 'DE_KN_residential6_washing_machine']\n['utc_timestamp', 'cet_cest_timestamp', 'interpolated', 'pv', 'freezer', 'grid_import', 'circulation_pump', 'ev', 'grid_export', 'heat_pump', 'dishwasher', 'refrigerator', 'washing_machine']\n"}]},"apps":[],"jobName":"paragraph_1612445870499_-1002688052","id":"20210204-133750_1506957959","dateCreated":"2021-02-04T13:37:50+0000","dateStarted":"2021-02-04T18:59:31+0000","dateFinished":"2021-02-04T18:59:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9179"},{"text":"%spark2.pyspark\n","user":"bd01","dateUpdated":"2021-02-04T18:56:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612465014413_-1732799006","id":"20210204-185654_1509293953","dateCreated":"2021-02-04T18:56:54+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16817"},{"text":"%spark2.pyspark\nget_cols_of_category(df, \"residential\", 1)","user":"bd01","dateUpdated":"2021-02-04T18:51:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612464635406_-769189229","id":"20210204-185035_921609807","dateCreated":"2021-02-04T18:50:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16691","dateFinished":"2021-02-04T18:51:16+0000","dateStarted":"2021-02-04T18:51:16+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['DE_KN_industrial3_ventilation', 'DE_KN_industrial3_machine_1', 'DE_KN_public2_grid_import', 'interpolated', 'DE_KN_industrial3_refrigerator', 'dishwasher', 'DE_KN_industrial3_pv_roof', 'DE_KN_industrial3_cooling_aggregate', 'DE_KN_public1_grid_import', 'DE_KN_industrial1_pv_2', 'DE_KN_industrial3_machine_3', 'DE_KN_industrial3_machine_4', 'DE_KN_industrial3_machine_5', 'grid_import', 'DE_KN_industrial3_area_room_2', 'DE_KN_industrial1_grid_import', 'DE_KN_industrial3_cooling_pumps', 'DE_KN_industrial3_area_offices', 'DE_KN_industrial3_grid_import', 'DE_KN_industrial3_ev', 'utc_timestamp', 'DE_KN_industrial3_dishwasher', 'DE_KN_industrial3_area_room_4', 'pv', 'DE_KN_industrial1_pv_1', 'DE_KN_industrial3_compressor', 'freezer', 'DE_KN_industrial3_area_room_3', 'circulation_pump', 'ev', 'DE_KN_industrial3_area_room_1', 'DE_KN_industrial2_pv', 'DE_KN_industrial2_storage_charge', 'heat_pump', 'grid_export', 'DE_KN_industrial3_machine_2', 'refrigerator', 'cet_cest_timestamp', 'DE_KN_industrial2_storage_decharge', 'DE_KN_industrial2_grid_import', 'DE_KN_industrial3_pv_facade', 'washing_machine']\n"}]}},{"text":"%spark2.pyspark\n# ls_cols_distinct =\nset([re.sub(f'DE\\_KN\\_{str_category}\\d_', '', col) for col in df.schema.names])\n\n# def get_clean_colnames(ls_cols, str_category, num):\n#     cols_clean = [re.sub(f'DE\\_KN\\_{str_category}\\d_', '', el) for el in ls_cols]\n#     return set(cols_additional + cols_clean) ","user":"bd01","dateUpdated":"2021-02-04T18:45:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612464172300_-567902827","id":"20210204-184252_2046581659","dateCreated":"2021-02-04T18:42:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16571","dateFinished":"2021-02-04T18:45:15+0000","dateStarted":"2021-02-04T18:45:15+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{'DE_KN_industrial3_ventilation', 'DE_KN_industrial3_machine_1', 'DE_KN_public2_grid_import', 'interpolated', 'DE_KN_industrial3_refrigerator', 'dishwasher', 'DE_KN_industrial3_pv_roof', 'DE_KN_industrial3_cooling_aggregate', 'DE_KN_public1_grid_import', 'DE_KN_industrial1_pv_2', 'DE_KN_industrial3_machine_3', 'DE_KN_industrial3_machine_4', 'DE_KN_industrial3_machine_5', 'grid_import', 'DE_KN_industrial3_area_room_2', 'DE_KN_industrial1_grid_import', 'DE_KN_industrial3_cooling_pumps', 'DE_KN_industrial3_area_offices', 'DE_KN_industrial3_grid_import', 'DE_KN_industrial3_ev', 'utc_timestamp', 'DE_KN_industrial3_dishwasher', 'DE_KN_industrial3_area_room_4', 'pv', 'DE_KN_industrial1_pv_1', 'DE_KN_industrial3_compressor', 'freezer', 'DE_KN_industrial3_area_room_3', 'circulation_pump', 'ev', 'DE_KN_industrial3_area_room_1', 'DE_KN_industrial2_pv', 'DE_KN_industrial2_storage_charge', 'heat_pump', 'grid_export', 'DE_KN_industrial3_machine_2', 'refrigerator', 'cet_cest_timestamp', 'DE_KN_industrial2_storage_decharge', 'DE_KN_industrial2_grid_import', 'DE_KN_industrial3_pv_facade', 'washing_machine'}\n"}]}},{"text":"%spark2.pyspark\ndf_residential1 = get_df_relevant(ls_cols=ls_cols,\n                                  str_category=\"residential\",\n                                  num=1)\ndf_residential2 = get_df_relevant(ls_cols=ls_cols,\n                                  str_category=\"residential\",\n                                  num=2)\ndf_residential3 = get_df_relevant(ls_cols=ls_cols,\n                                  str_category=\"residential\",\n                                  num=3)\ndf_residential4 = get_df_relevant(ls_cols=ls_cols,\n                                  str_category=\"residential\",\n                                  num=4)\ndf_residential5 = get_df_relevant(ls_cols=ls_cols,\n                                  str_category=\"residential\",\n                                  num=5)\ndf_residential6 = get_df_relevant(ls_cols=ls_cols,\n                                  str_category=\"residential\",\n                                  num=6)\n\n","user":"bd01","dateUpdated":"2021-02-04T18:37:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612463490705_1283601306","id":"20210204-183130_1170429062","dateCreated":"2021-02-04T18:31:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15958","dateFinished":"2021-02-04T18:37:33+0000","dateStarted":"2021-02-04T18:37:33+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark2.pyspark\ndf_residential2.union(df_residential3)","user":"bd01","dateUpdated":"2021-02-04T18:39:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612463867859_146144067","id":"20210204-183747_1448122207","dateCreated":"2021-02-04T18:37:47+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16404","dateFinished":"2021-02-04T18:39:15+0000","dateStarted":"2021-02-04T18:39:15+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 1: df_residential2.union(df_residential3)\nTraceback (most recent call last):\n  File \"/usr/hdp/current/spark2-client/python/lib/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/usr/hdp/current/spark2-client/python/lib/py4j-0.10.7-src.zip/py4j/protocol.py\", line 328, in get_return_value\n    format(target_id, \".\", name), value)\npy4j.protocol.Py4JJavaError: An error occurred while calling o3108.union.\n: org.apache.spark.sql.AnalysisException: Union can only be performed on tables with the same number of columns, but the first table has 9 columns and the second table has 12 columns;;\n'Union\n:- Project [grid_import#12327, washing_machine#12298, interpolated#7820, dishwasher#12288, DE_KN_residential2_circulation_pump#7787 AS circulation_pump#12346, cet_cest_timestamp#7751, freezer#12317, utc_timestamp#7750, unit#12269]\n:  +- Project [DE_KN_residential2_grid_import#7790 AS grid_import#12327, washing_machine#12298, interpolated#7820, dishwasher#12288, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, freezer#12317, utc_timestamp#7750, unit#12269]\n:     +- Project [DE_KN_residential2_grid_import#7790, washing_machine#12298, interpolated#7820, dishwasher#12288, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789 AS freezer#12317, utc_timestamp#7750, unit#12269]\n:        +- Project [DE_KN_residential2_grid_import#7790, DE_KN_residential2_washing_machine#7791 AS washing_machine#12298, interpolated#7820, dishwasher#12288, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789, utc_timestamp#7750, unit#12269]\n:           +- Project [DE_KN_residential2_grid_import#7790, DE_KN_residential2_washing_machine#7791, interpolated#7820, DE_KN_residential2_dishwasher#7788 AS dishwasher#12288, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789, utc_timestamp#7750, unit#12269]\n:              +- Project [DE_KN_residential2_grid_import#7790, DE_KN_residential2_washing_machine#7791, interpolated#7820, DE_KN_residential2_dishwasher#7788, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789, utc_timestamp#7750, 2 AS unit#12269]\n:                 +- Project [DE_KN_residential2_grid_import#7790, DE_KN_residential2_washing_machine#7791, interpolated#7820, DE_KN_residential2_dishwasher#7788, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789, utc_timestamp#7750]\n:                    +- Relation[utc_timestamp#7750,cet_cest_timestamp#7751,DE_KN_industrial1_grid_import#7752,DE_KN_industrial1_pv_1#7753,DE_KN_industrial1_pv_2#7754,DE_KN_industrial2_grid_import#7755,DE_KN_industrial2_pv#7756,DE_KN_industrial2_storage_charge#7757,DE_KN_industrial2_storage_decharge#7758,DE_KN_industrial3_area_offices#7759,DE_KN_industrial3_area_room_1#7760,DE_KN_industrial3_area_room_2#7761,DE_KN_industrial3_area_room_3#7762,DE_KN_industrial3_area_room_4#7763,DE_KN_industrial3_compressor#7764,DE_KN_industrial3_cooling_aggregate#7765,DE_KN_industrial3_cooling_pumps#7766,DE_KN_industrial3_dishwasher#7767,DE_KN_industrial3_ev#7768,DE_KN_industrial3_grid_import#7769,DE_KN_industrial3_machine_1#7770,DE_KN_industrial3_machine_2#7771,DE_KN_industrial3_machine_3#7772,DE_KN_industrial3_machine_4#7773,... 47 more fields] csv\n+- Project [freezer#12440, DE_KN_residential3_refrigerator#7798 AS refrigerator#12492, dishwasher#12402, washing_machine#12415, interpolated#7820, grid_export#12466, grid_import#12453, circulation_pump#12479, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\n   +- Project [freezer#12440, DE_KN_residential3_refrigerator#7798, dishwasher#12402, washing_machine#12415, interpolated#7820, grid_export#12466, grid_import#12453, DE_KN_residential3_circulation_pump#7792 AS circulation_pump#12479, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\n      +- Project [freezer#12440, DE_KN_residential3_refrigerator#7798, dishwasher#12402, washing_machine#12415, interpolated#7820, DE_KN_residential3_grid_export#7795 AS grid_export#12466, grid_import#12453, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\n         +- Project [freezer#12440, DE_KN_residential3_refrigerator#7798, dishwasher#12402, washing_machine#12415, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796 AS grid_import#12453, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\n            +- Project [DE_KN_residential3_freezer#7794 AS freezer#12440, DE_KN_residential3_refrigerator#7798, dishwasher#12402, washing_machine#12415, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\n               +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, dishwasher#12402, DE_KN_residential3_washing_machine#7799 AS washing_machine#12415, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\n                  +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, DE_KN_residential3_dishwasher#7793 AS dishwasher#12402, DE_KN_residential3_washing_machine#7799, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\n                     +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, DE_KN_residential3_dishwasher#7793, DE_KN_residential3_washing_machine#7799, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, DE_KN_residential3_pv#7797 AS pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\n                        +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, DE_KN_residential3_dishwasher#7793, DE_KN_residential3_washing_machine#7799, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, DE_KN_residential3_pv#7797, cet_cest_timestamp#7751, utc_timestamp#7750, 3 AS unit#12376]\n                           +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, DE_KN_residential3_dishwasher#7793, DE_KN_residential3_washing_machine#7799, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, DE_KN_residential3_pv#7797, cet_cest_timestamp#7751, utc_timestamp#7750]\n                              +- Relation[utc_timestamp#7750,cet_cest_timestamp#7751,DE_KN_industrial1_grid_import#7752,DE_KN_industrial1_pv_1#7753,DE_KN_industrial1_pv_2#7754,DE_KN_industrial2_grid_import#7755,DE_KN_industrial2_pv#7756,DE_KN_industrial2_storage_charge#7757,DE_KN_industrial2_storage_decharge#7758,DE_KN_industrial3_area_offices#7759,DE_KN_industrial3_area_room_1#7760,DE_KN_industrial3_area_room_2#7761,DE_KN_industrial3_area_room_3#7762,DE_KN_industrial3_area_room_4#7763,DE_KN_industrial3_compressor#7764,DE_KN_industrial3_cooling_aggregate#7765,DE_KN_industrial3_cooling_pumps#7766,DE_KN_industrial3_dishwasher#7767,DE_KN_industrial3_ev#7768,DE_KN_industrial3_grid_import#7769,DE_KN_industrial3_machine_1#7770,DE_KN_industrial3_machine_2#7771,DE_KN_industrial3_machine_3#7772,DE_KN_industrial3_machine_4#7773,... 47 more fields] csv\n\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.failAnalysis(CheckAnalysis.scala:41)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.failAnalysis(Analyzer.scala:92)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$11.apply(CheckAnalysis.scala:249)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$11.apply(CheckAnalysis.scala:246)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:246)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:84)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:127)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:84)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:92)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:105)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:57)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:47)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:74)\n\tat org.apache.spark.sql.Dataset.withSetOperator(Dataset.scala:3313)\n\tat org.apache.spark.sql.Dataset.union(Dataset.scala:1834)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-5406178559337363436.py\", line 380, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/hdp/current/spark2-client/python/lib/pyspark.zip/pyspark/sql/dataframe.py\", line 1338, in union\n    return DataFrame(self._jdf.union(other._jdf), self.sql_ctx)\n  File \"/usr/hdp/current/spark2-client/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/usr/hdp/current/spark2-client/python/lib/pyspark.zip/pyspark/sql/utils.py\", line 69, in deco\n    raise AnalysisException(s.split(': ', 1)[1], stackTrace)\npyspark.sql.utils.AnalysisException: \"Union can only be performed on tables with the same number of columns, but the first table has 9 columns and the second table has 12 columns;;\\n'Union\\n:- Project [grid_import#12327, washing_machine#12298, interpolated#7820, dishwasher#12288, DE_KN_residential2_circulation_pump#7787 AS circulation_pump#12346, cet_cest_timestamp#7751, freezer#12317, utc_timestamp#7750, unit#12269]\\n:  +- Project [DE_KN_residential2_grid_import#7790 AS grid_import#12327, washing_machine#12298, interpolated#7820, dishwasher#12288, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, freezer#12317, utc_timestamp#7750, unit#12269]\\n:     +- Project [DE_KN_residential2_grid_import#7790, washing_machine#12298, interpolated#7820, dishwasher#12288, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789 AS freezer#12317, utc_timestamp#7750, unit#12269]\\n:        +- Project [DE_KN_residential2_grid_import#7790, DE_KN_residential2_washing_machine#7791 AS washing_machine#12298, interpolated#7820, dishwasher#12288, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789, utc_timestamp#7750, unit#12269]\\n:           +- Project [DE_KN_residential2_grid_import#7790, DE_KN_residential2_washing_machine#7791, interpolated#7820, DE_KN_residential2_dishwasher#7788 AS dishwasher#12288, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789, utc_timestamp#7750, unit#12269]\\n:              +- Project [DE_KN_residential2_grid_import#7790, DE_KN_residential2_washing_machine#7791, interpolated#7820, DE_KN_residential2_dishwasher#7788, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789, utc_timestamp#7750, 2 AS unit#12269]\\n:                 +- Project [DE_KN_residential2_grid_import#7790, DE_KN_residential2_washing_machine#7791, interpolated#7820, DE_KN_residential2_dishwasher#7788, DE_KN_residential2_circulation_pump#7787, cet_cest_timestamp#7751, DE_KN_residential2_freezer#7789, utc_timestamp#7750]\\n:                    +- Relation[utc_timestamp#7750,cet_cest_timestamp#7751,DE_KN_industrial1_grid_import#7752,DE_KN_industrial1_pv_1#7753,DE_KN_industrial1_pv_2#7754,DE_KN_industrial2_grid_import#7755,DE_KN_industrial2_pv#7756,DE_KN_industrial2_storage_charge#7757,DE_KN_industrial2_storage_decharge#7758,DE_KN_industrial3_area_offices#7759,DE_KN_industrial3_area_room_1#7760,DE_KN_industrial3_area_room_2#7761,DE_KN_industrial3_area_room_3#7762,DE_KN_industrial3_area_room_4#7763,DE_KN_industrial3_compressor#7764,DE_KN_industrial3_cooling_aggregate#7765,DE_KN_industrial3_cooling_pumps#7766,DE_KN_industrial3_dishwasher#7767,DE_KN_industrial3_ev#7768,DE_KN_industrial3_grid_import#7769,DE_KN_industrial3_machine_1#7770,DE_KN_industrial3_machine_2#7771,DE_KN_industrial3_machine_3#7772,DE_KN_industrial3_machine_4#7773,... 47 more fields] csv\\n+- Project [freezer#12440, DE_KN_residential3_refrigerator#7798 AS refrigerator#12492, dishwasher#12402, washing_machine#12415, interpolated#7820, grid_export#12466, grid_import#12453, circulation_pump#12479, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\\n   +- Project [freezer#12440, DE_KN_residential3_refrigerator#7798, dishwasher#12402, washing_machine#12415, interpolated#7820, grid_export#12466, grid_import#12453, DE_KN_residential3_circulation_pump#7792 AS circulation_pump#12479, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\\n      +- Project [freezer#12440, DE_KN_residential3_refrigerator#7798, dishwasher#12402, washing_machine#12415, interpolated#7820, DE_KN_residential3_grid_export#7795 AS grid_export#12466, grid_import#12453, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\\n         +- Project [freezer#12440, DE_KN_residential3_refrigerator#7798, dishwasher#12402, washing_machine#12415, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796 AS grid_import#12453, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\\n            +- Project [DE_KN_residential3_freezer#7794 AS freezer#12440, DE_KN_residential3_refrigerator#7798, dishwasher#12402, washing_machine#12415, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\\n               +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, dishwasher#12402, DE_KN_residential3_washing_machine#7799 AS washing_machine#12415, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\\n                  +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, DE_KN_residential3_dishwasher#7793 AS dishwasher#12402, DE_KN_residential3_washing_machine#7799, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\\n                     +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, DE_KN_residential3_dishwasher#7793, DE_KN_residential3_washing_machine#7799, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, DE_KN_residential3_pv#7797 AS pv#12389, cet_cest_timestamp#7751, utc_timestamp#7750, unit#12376]\\n                        +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, DE_KN_residential3_dishwasher#7793, DE_KN_residential3_washing_machine#7799, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, DE_KN_residential3_pv#7797, cet_cest_timestamp#7751, utc_timestamp#7750, 3 AS unit#12376]\\n                           +- Project [DE_KN_residential3_freezer#7794, DE_KN_residential3_refrigerator#7798, DE_KN_residential3_dishwasher#7793, DE_KN_residential3_washing_machine#7799, interpolated#7820, DE_KN_residential3_grid_export#7795, DE_KN_residential3_grid_import#7796, DE_KN_residential3_circulation_pump#7792, DE_KN_residential3_pv#7797, cet_cest_timestamp#7751, utc_timestamp#7750]\\n                              +- Relation[utc_timestamp#7750,cet_cest_timestamp#7751,DE_KN_industrial1_grid_import#7752,DE_KN_industrial1_pv_1#7753,DE_KN_industrial1_pv_2#7754,DE_KN_industrial2_grid_import#7755,DE_KN_industrial2_pv#7756,DE_KN_industrial2_storage_charge#7757,DE_KN_industrial2_storage_decharge#7758,DE_KN_industrial3_area_offices#7759,DE_KN_industrial3_area_room_1#7760,DE_KN_industrial3_area_room_2#7761,DE_KN_industrial3_area_room_3#7762,DE_KN_industrial3_area_room_4#7763,DE_KN_industrial3_compressor#7764,DE_KN_industrial3_cooling_aggregate#7765,DE_KN_industrial3_cooling_pumps#7766,DE_KN_industrial3_dishwasher#7767,DE_KN_industrial3_ev#7768,DE_KN_industrial3_grid_import#7769,DE_KN_industrial3_machine_1#7770,DE_KN_industrial3_machine_2#7771,DE_KN_industrial3_machine_3#7772,DE_KN_industrial3_machine_4#7773,... 47 more fields] csv\\n\"\n"}]}},{"text":"%spark2.pyspark\nmax(len(df_residential1.schema.names), \n    len(df_residential2.schema.names),\n    len(df_residential3.schema.names),\n    len(df_residential4.schema.names),\n    len(df_residential5.schema.names),\n    len(df_residential6.schema.names))\n","user":"bd01","dateUpdated":"2021-02-04T18:40:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612463610232_-1697535908","id":"20210204-183330_1566123028","dateCreated":"2021-02-04T18:33:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16087","dateFinished":"2021-02-04T18:40:17+0000","dateStarted":"2021-02-04T18:40:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"13\n"}]}},{"text":"%spark2.pyspark\nls_cols = df.schema.names\n\ndef get_df_renamed(df)\n\ndf_r1 = df.select(get_cols_relevant(ls_cols=ls_cols, \n                                     str_category=\"residential\", \n                                     num=1)).withColumn(\"unit\", lit(1))\ndf_r1 = df_r1.withColumnRenamed('DE_KN_residential1_pv', 'pv')\ndf_r1 = df_r1.withColumnRenamed('DE_KN_residential1_dishwasher', 'dishwasher')\ndf_r1 = df_r1.withColumnRenamed('DE_KN_residential1_washing_machine', 'washing_machine')\ndf_r1 = df_r1.withColumnRenamed('DE_KN_residential1_heat_pump', 'heat_pump')\ndf_r1 = df_r1.withColumnRenamed('DE_KN_residential1_freezer', 'freezer')\ndf_r1 = df_r1.withColumnRenamed('DE_KN_residential1_grid_import', 'grid_import')\ndf_r1 = df_r1.withColumnRenamed('DE_KN_residential2_circulation_pump', 'circulation_pump')\n# df_r1.show()\n\n# df_r2\ndf_r2 = df.select(get_cols_relevant(ls_cols=ls_cols, \n                                     str_category=\"residential\", \n                                     num=2))\ndf_r2 = df_r2.withColumnRenamed('DE_KN_residential2_pv', 'pv')\ndf_r2 = df_r2.withColumnRenamed('DE_KN_residential2_dishwasher', 'dishwasher')\ndf_r2 = df_r2.withColumnRenamed('DE_KN_residential2_washing_machine', 'washing_machine')\ndf_r2 = df_r2.withColumnRenamed('DE_KN_residential2_heat_pump', 'heat_pump')\ndf_r2 = df_r2.withColumnRenamed('DE_KN_residential2_freezer', 'freezer')\ndf_r2 = df_r2.withColumnRenamed('DE_KN_residential2_grid_import', 'grid_import')\ndf_r2 = df_r2.withColumnRenamed('DE_KN_residential2_circulation_pump', 'circulation_pump')\n\n# df_r2.show()\n\ndf_r3 = df.select(get_cols_relevant(ls_cols=ls_cols, \n                                     str_category=\"residential\", \n                                     num=3))\ndf_r3 = df_r3.withColumnRenamed('DE_KN_residential3_pv', 'pv')\ndf_r3 = df_r3.withColumnRenamed('DE_KN_residential3_dishwasher', 'dishwasher')\ndf_r3 = df_r3.withColumnRenamed('DE_KN_residential3_washing_machine', 'washing_machine')\ndf_r3 = df_r3.withColumnRenamed('DE_KN_residential3_heat_pump', 'heat_pump')\ndf_r3 = df_r3.withColumnRenamed('DE_KN_residential3_freezer', 'freezer')\ndf_r3 = df_r3.withColumnRenamed('DE_KN_residential3_grid_import', 'grid_import')\ndf_r3 = df_r3.withColumnRenamed('DE_KN_residential3_circulation_pump', 'circulation_pump')\n\ndf_r2.show()\n","user":"bd01","dateUpdated":"2021-02-04T18:25:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612461677492_201008973","id":"20210204-180117_1310808363","dateCreated":"2021-02-04T18:01:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14708","dateFinished":"2021-02-04T18:24:35+0000","dateStarted":"2021-02-04T18:24:34+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+---------------+--------------------+----------+----------------+--------------------+-------+--------------------+\n|grid_import|washing_machine|        interpolated|dishwasher|circulation_pump|  cet_cest_timestamp|freezer|       utc_timestamp|\n+-----------+---------------+--------------------+----------+----------------+--------------------+-------+--------------------+\n|       null|           null|                null|      null|            null|2014-12-11T18:00:...|   null|2014-12-11T17:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-11T19:00:...|   null|2014-12-11T18:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-11T20:00:...|   null|2014-12-11T19:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-11T21:00:...|   null|2014-12-11T20:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-11T22:00:...|   null|2014-12-11T21:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-11T23:00:...|   null|2014-12-11T22:00:00Z|\n|       null|           null|DE_KN_residential...|      null|            null|2014-12-12T00:00:...|   null|2014-12-11T23:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T01:00:...|   null|2014-12-12T00:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T02:00:...|   null|2014-12-12T01:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T03:00:...|   null|2014-12-12T02:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T04:00:...|   null|2014-12-12T03:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T05:00:...|   null|2014-12-12T04:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T06:00:...|   null|2014-12-12T05:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T07:00:...|   null|2014-12-12T06:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T08:00:...|   null|2014-12-12T07:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T09:00:...|   null|2014-12-12T08:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T10:00:...|   null|2014-12-12T09:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T11:00:...|   null|2014-12-12T10:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T12:00:...|   null|2014-12-12T11:00:00Z|\n|       null|           null|                null|      null|            null|2014-12-12T13:00:...|   null|2014-12-12T12:00:00Z|\n+-----------+---------------+--------------------+----------+----------------+--------------------+-------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=115"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\ndf_r1.show()","user":"bd01","dateUpdated":"2021-02-04T18:15:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612462071625_-1622125126","id":"20210204-180751_1443332842","dateCreated":"2021-02-04T18:07:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15246","dateFinished":"2021-02-04T18:15:42+0000","dateStarted":"2021-02-04T18:15:41+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------+--------------------+-----------------------------+----------------------------------+----------------------------+--------------------+--------------------------+------------------------------+--------------------+----+\n|DE_KN_residential1_pv|  cet_cest_timestamp|DE_KN_residential1_dishwasher|DE_KN_residential1_washing_machine|DE_KN_residential1_heat_pump|        interpolated|DE_KN_residential1_freezer|DE_KN_residential1_grid_import|       utc_timestamp|unit|\n+---------------------+--------------------+-----------------------------+----------------------------------+----------------------------+--------------------+--------------------------+------------------------------+--------------------+----+\n|                 null|2014-12-11T18:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-11T17:00:00Z|   1|\n|                 null|2014-12-11T19:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-11T18:00:00Z|   1|\n|                 null|2014-12-11T20:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-11T19:00:00Z|   1|\n|                 null|2014-12-11T21:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-11T20:00:00Z|   1|\n|                 null|2014-12-11T22:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-11T21:00:00Z|   1|\n|                 null|2014-12-11T23:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-11T22:00:00Z|   1|\n|                 null|2014-12-12T00:00:...|                         null|                              null|                        null|DE_KN_residential...|                      null|                          null|2014-12-11T23:00:00Z|   1|\n|                 null|2014-12-12T01:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T00:00:00Z|   1|\n|                 null|2014-12-12T02:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T01:00:00Z|   1|\n|                 null|2014-12-12T03:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T02:00:00Z|   1|\n|                 null|2014-12-12T04:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T03:00:00Z|   1|\n|                 null|2014-12-12T05:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T04:00:00Z|   1|\n|                 null|2014-12-12T06:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T05:00:00Z|   1|\n|                 null|2014-12-12T07:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T06:00:00Z|   1|\n|                 null|2014-12-12T08:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T07:00:00Z|   1|\n|                 null|2014-12-12T09:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T08:00:00Z|   1|\n|                 null|2014-12-12T10:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T09:00:00Z|   1|\n|                 null|2014-12-12T11:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T10:00:00Z|   1|\n|                 null|2014-12-12T12:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T11:00:00Z|   1|\n|                 null|2014-12-12T13:00:...|                         null|                              null|                        null|                null|                      null|                          null|2014-12-12T12:00:00Z|   1|\n+---------------------+--------------------+-----------------------------+----------------------------------+----------------------------+--------------------+--------------------------+------------------------------+--------------------+----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=108"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\ndf_r3.show()","user":"bd01","dateUpdated":"2021-02-04T18:06:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612461984625_1500549178","id":"20210204-180624_2127407665","dateCreated":"2021-02-04T18:06:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15025","dateFinished":"2021-02-04T18:06:59+0000","dateStarted":"2021-02-04T18:06:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------------+-------------------------------+-----------------------------+----------------------------------+--------------------+------------------------------+------------------------------+-----------------------------------+---------------------+--------------------+--------------------+\n|DE_KN_residential3_freezer|DE_KN_residential3_refrigerator|DE_KN_residential3_dishwasher|DE_KN_residential3_washing_machine|        interpolated|DE_KN_residential3_grid_export|DE_KN_residential3_grid_import|DE_KN_residential3_circulation_pump|DE_KN_residential3_pv|  cet_cest_timestamp|       utc_timestamp|\n+--------------------------+-------------------------------+-----------------------------+----------------------------------+--------------------+------------------------------+------------------------------+-----------------------------------+---------------------+--------------------+--------------------+\n|                     0.002|                           null|                        0.000|                              null|                null|                          null|                          null|                               null|                 null|2014-12-11T18:00:...|2014-12-11T17:00:00Z|\n|                     0.024|                           null|                        0.003|                             0.000|                null|                          null|                          null|                              0.063|                 null|2014-12-11T19:00:...|2014-12-11T18:00:00Z|\n|                     0.064|                           null|                        0.005|                             0.000|                null|                          null|                          null|                              0.132|                 null|2014-12-11T20:00:...|2014-12-11T19:00:00Z|\n|                     0.102|                           null|                        0.008|                             0.000|                null|                          null|                          null|                              0.200|                 null|2014-12-11T21:00:...|2014-12-11T20:00:00Z|\n|                     0.106|                           null|                        0.010|                             0.000|                null|                          null|                          null|                              0.269|                 null|2014-12-11T22:00:...|2014-12-11T21:00:00Z|\n|                     0.146|                           null|                        0.013|                             0.000|                null|                          null|                          null|                              0.310|                 null|2014-12-11T23:00:...|2014-12-11T22:00:00Z|\n|                     0.185|                           null|                        0.016|                             0.000|DE_KN_residential...|                          null|                          null|                              0.369|                 null|2014-12-12T00:00:...|2014-12-11T23:00:00Z|\n|                     0.201|                           null|                        0.018|                             0.000|                null|                          null|                          null|                              0.440|                 null|2014-12-12T01:00:...|2014-12-12T00:00:00Z|\n|                     0.228|                           null|                        0.021|                             0.000|                null|                          null|                          null|                              0.507|                 null|2014-12-12T02:00:...|2014-12-12T01:00:00Z|\n|                     0.268|                           null|                        0.023|                             0.000|                null|                          null|                          null|                              0.579|                 null|2014-12-12T03:00:...|2014-12-12T02:00:00Z|\n|                     0.300|                           null|                        0.026|                             0.001|                null|                          null|                          null|                              0.647|                 null|2014-12-12T04:00:...|2014-12-12T03:00:00Z|\n|                     0.309|                           null|                        0.028|                             0.001|                null|                          null|                          null|                              0.717|                 null|2014-12-12T05:00:...|2014-12-12T04:00:00Z|\n|                     0.349|                           null|                        0.031|                             0.001|                null|                          null|                          null|                              0.789|                 null|2014-12-12T06:00:...|2014-12-12T05:00:00Z|\n|                     0.388|                           null|                        0.079|                             0.001|                null|                          null|                          null|                              0.857|                 null|2014-12-12T07:00:...|2014-12-12T06:00:00Z|\n|                     0.394|                           null|                        1.293|                             0.001|                null|                          null|                          null|                              0.932|                 null|2014-12-12T08:00:...|2014-12-12T07:00:00Z|\n|                     0.430|                           null|                        1.298|                             0.001|                null|                          null|                          null|                              1.020|                 null|2014-12-12T09:00:...|2014-12-12T08:00:00Z|\n|                     0.469|                           null|                        1.300|                             0.001|                null|                          null|                          null|                              1.139|                 null|2014-12-12T10:00:...|2014-12-12T09:00:00Z|\n|                     0.491|                           null|                        1.303|                             0.001|                null|                          null|                          null|                              1.257|                 null|2014-12-12T11:00:...|2014-12-12T10:00:00Z|\n|                     0.510|                           null|                        1.305|                             0.001|                null|                          null|                          null|                              1.368|                 null|2014-12-12T12:00:...|2014-12-12T11:00:00Z|\n|                     0.550|                           null|                        1.308|                             0.001|                null|                          null|                          null|                              1.470|                 null|2014-12-12T13:00:...|2014-12-12T12:00:00Z|\n+--------------------------+-------------------------------+-----------------------------+----------------------------------+--------------------+------------------------------+------------------------------+-----------------------------------+---------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=106"],"interpreterSettingId":"spark2"}}},{"text":"# def get_clean_colnames(ls_cols, str_category, num):\n#     cols_clean = [re.sub(f'DE\\_KN\\_{str_category}\\d_', '', el) for el in ls_cols]\n#     return set(cols_additional + cols_clean) \n","user":"bd01","dateUpdated":"2021-02-04T18:00:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false,"completionKey":"TAB"},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612460764931_1499564637","id":"20210204-174604_252365443","dateCreated":"2021-02-04T17:46:04+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13993"},{"text":"%spark2.pyspark\n\n\n# df.show()\n\n# df1 = df.withColumnRenamed('DE_KN_residential1_pv', 'pv').show()\n# df.withColumnRenamed('DE_KN_residential1_dishwasher', 'dishwasher')\n# df.withColumnRenamed('DE_KN_residential1_pv', 'pv')\n# df.withColumnRenamed('DE_KN_residential1_pv', 'pv')\n# df.withColumnRenamed('DE_KN_residential1_pv', 'pv')\n# df.withColumnRenamed('DE_KN_residential1_pv', 'pv')\n\n","user":"bd01","dateUpdated":"2021-02-04T18:01:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612457942628_-1950774884","id":"20210204-165902_2034578906","dateCreated":"2021-02-04T16:59:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12270","dateFinished":"2021-02-04T17:59:14+0000","dateStarted":"2021-02-04T17:59:13+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark2.pyspark\nls_cols_category","user":"bd01","dateUpdated":"2021-02-04T17:59:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612461558197_344097850","id":"20210204-175918_1390330062","dateCreated":"2021-02-04T17:59:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14476","dateFinished":"2021-02-04T17:59:23+0000","dateStarted":"2021-02-04T17:59:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['DE_KN_residential1_pv', 'cet_cest_timestamp', 'DE_KN_residential1_dishwasher', 'DE_KN_residential1_washing_machine', 'DE_KN_residential1_heat_pump', 'interpolated', 'DE_KN_residential1_freezer', 'DE_KN_residential1_grid_import', 'utc_timestamp']\n"}]}},{"text":"%spark2.pyspark\nfrom pyspark.sql import functions as F\ndf_bank_age_balance_avg = df_bank.groupBy(\"age\").agg(F.avg(\"balance\").alias(\"balance_avg\"))\ndf_bank_age_balance_avg.orderBy(\"age\").show(10)\n\ndf_bank_age_job_cnt = df_bank.groupBy(\"age\", \"job\").agg(F.count(\"*\").alias(\"cnt\"))\ndf_bank_age_job_cnt_orderd = df_bank_age_job_cnt.orderBy(\"age\", \"job\")\ndf_bank_age_job_cnt_orderd.show(10)\n","user":"bd01","dateUpdated":"2021-02-04T17:20:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612459237894_-437193710","id":"20210204-172037_697945972","dateCreated":"2021-02-04T17:20:37+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13846"},{"text":"%spark2.pyspark\ndf.p","user":"bd01","dateUpdated":"2021-02-04T17:19:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612459186781_-907240125","id":"20210204-171946_834183324","dateCreated":"2021-02-04T17:19:46+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13736"},{"text":"%spark2.pyspark\ndf","user":"bd01","dateUpdated":"2021-02-04T17:04:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612458028384_1199801700","id":"20210204-170028_1270156014","dateCreated":"2021-02-04T17:00:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12483","dateFinished":"2021-02-04T17:04:44+0000","dateStarted":"2021-02-04T17:04:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[DE_KN_residential1_dishwasher: string, DE_KN_residential1_freezer: string, DE_KN_residential1_grid_import: string, DE_KN_residential1_heat_pump: string, DE_KN_residential1_pv: string, DE_KN_residential1_washing_machine: string, utc_timestamp: string, cet_cest_timestamp: string, interpolated: string, DE_KN_residential1_dishwasher: string, DE_KN_residential1_freezer: string, DE_KN_residential1_grid_import: string, DE_KN_residential1_heat_pump: string, DE_KN_residential1_pv: string, DE_KN_residential1_washing_machine: string]\n"}]}},{"text":"%spark2.pyspark\n","user":"bd01","dateUpdated":"2021-02-04T17:00:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612457973904_-1341652797","id":"20210204-165933_1606385703","dateCreated":"2021-02-04T16:59:33+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12385"},{"text":"%spark2.pyspark\n\nls_cols = df.schema.names\n\ndf1 = get_df_cleaned(ls_cols=ls_cols, \n                   str_category=\"residential\", \n                   num=1)\ndf1.summary().show()\n\n","user":"bd01","dateUpdated":"2021-02-04T17:00:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612457792861_-188567976","id":"20210204-165632_80774932","dateCreated":"2021-02-04T16:56:32+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12151","dateFinished":"2021-02-04T16:59:30+0000","dateStarted":"2021-02-04T16:59:29+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 5:                    num=1)\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-5406178559337363436.py\", line 375, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 5, in <module>\n  File \"<stdin>\", line 19, in get_df_cleaned\nNameError: name 'ls_cols_category' is not defined\n"}]}},{"text":"%spark2.pyspark\n# finish\ndef get_clean_colnames(cols, category_string, num):\n    cols_additional = [\"utc_timestamp\" , \"cet_cest_timestamp\", \"interpolated\"]\n    cols_category = get_categorical_colnames(cols, category_string, num)\n    cols_clean = [re.sub(f'DE\\_KN\\_{category_string}\\d_', '', el) for el in cols_category]\n    return set(cols_additional + cols_clean) \n\n\ncols_residential_1 = get_clean_colnames(cols, \"residential\", num=1) \ncols_residential_2 = get_clean_colnames(cols, \"residential\", num=2) \ncols_residential_3 = get_clean_colnames(cols, \"residential\", num=3) \ncols_residential_4 = get_clean_colnames(cols, \"residential\", num=4) \ncols_residential_5 = get_clean_colnames(cols, \"residential\", num=5) \ncols_residential_6 = get_clean_colnames(cols, \"residential\", num=6) \n\n#cols_industrial  = get_categorical_colnames(cols, \"industrial\")\n#cols_public      = get_categorical_colnames(cols, \"public\")\n\n#cols_residential_clean = get_categorical_colnames(cols, \"residential\")\n#cols_industrial_clean  = get_categorical_colnames(cols, \"industrial\")\n#cols_public_clean      = get_categorical_colnames(cols, \"public\")\n\n#df_residential = df.select(cols_residential)\n#df_industrial = df.select(cols_industrial)\n#df_public = df.select(cols_public)\n\nprint(cols_residential_1)\n","user":"bd01","dateUpdated":"2021-02-04T17:00:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612456759351_-1546741719","id":"20210204-163919_1469595692","dateCreated":"2021-02-04T16:39:19+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11008"},{"text":"%spark2.pyspark\ndf_residential1.select()","user":"bd01","dateUpdated":"2021-02-04T17:00:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+-----------------------------+--------------------------+------------------------------+----------------------------+---------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+---------------------+--------------------------+------------------------------+------------------------------+----------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+------------------------------+-------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+----------------------------------+\n|       utc_timestamp|  cet_cest_timestamp|        interpolated|DE_KN_residential1_dishwasher|DE_KN_residential1_freezer|DE_KN_residential1_grid_import|DE_KN_residential1_heat_pump|DE_KN_residential1_pv|DE_KN_residential1_washing_machine|DE_KN_residential2_circulation_pump|DE_KN_residential2_dishwasher|DE_KN_residential2_freezer|DE_KN_residential2_grid_import|DE_KN_residential2_washing_machine|DE_KN_residential3_circulation_pump|DE_KN_residential3_dishwasher|DE_KN_residential3_freezer|DE_KN_residential3_grid_export|DE_KN_residential3_grid_import|DE_KN_residential3_pv|DE_KN_residential3_refrigerator|DE_KN_residential3_washing_machine|DE_KN_residential4_dishwasher|DE_KN_residential4_ev|DE_KN_residential4_freezer|DE_KN_residential4_grid_export|DE_KN_residential4_grid_import|DE_KN_residential4_heat_pump|DE_KN_residential4_pv|DE_KN_residential4_refrigerator|DE_KN_residential4_washing_machine|DE_KN_residential5_dishwasher|DE_KN_residential5_grid_import|DE_KN_residential5_refrigerator|DE_KN_residential5_washing_machine|DE_KN_residential6_circulation_pump|DE_KN_residential6_dishwasher|DE_KN_residential6_freezer|DE_KN_residential6_grid_export|DE_KN_residential6_grid_import|DE_KN_residential6_pv|DE_KN_residential6_washing_machine|\n+--------------------+--------------------+--------------------+-----------------------------+--------------------------+------------------------------+----------------------------+---------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+---------------------+--------------------------+------------------------------+------------------------------+----------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+------------------------------+-------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+----------------------------------+\n|2014-12-11T17:00:00Z|2014-12-11T18:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                               null|                        0.000|                     0.002|                          null|                          null|                 null|                           null|                              null|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T18:00:00Z|2014-12-11T19:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.063|                        0.003|                     0.024|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T19:00:00Z|2014-12-11T20:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.132|                        0.005|                     0.064|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T20:00:00Z|2014-12-11T21:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.200|                        0.008|                     0.102|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T21:00:00Z|2014-12-11T22:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.269|                        0.010|                     0.106|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T22:00:00Z|2014-12-11T23:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.310|                        0.013|                     0.146|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-11T23:00:00Z|2014-12-12T00:00:...|DE_KN_residential...|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.369|                        0.016|                     0.185|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T00:00:00Z|2014-12-12T01:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.440|                        0.018|                     0.201|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T01:00:00Z|2014-12-12T02:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.507|                        0.021|                     0.228|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T02:00:00Z|2014-12-12T03:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.579|                        0.023|                     0.268|                          null|                          null|                 null|                           null|                             0.000|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T03:00:00Z|2014-12-12T04:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.647|                        0.026|                     0.300|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T04:00:00Z|2014-12-12T05:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.717|                        0.028|                     0.309|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T05:00:00Z|2014-12-12T06:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.789|                        0.031|                     0.349|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T06:00:00Z|2014-12-12T07:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.857|                        0.079|                     0.388|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T07:00:00Z|2014-12-12T08:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              0.932|                        1.293|                     0.394|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T08:00:00Z|2014-12-12T09:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.020|                        1.298|                     0.430|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T09:00:00Z|2014-12-12T10:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.139|                        1.300|                     0.469|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T10:00:00Z|2014-12-12T11:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.257|                        1.303|                     0.491|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T11:00:00Z|2014-12-12T12:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.368|                        1.305|                     0.510|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n|2014-12-12T12:00:00Z|2014-12-12T13:00:...|                null|                         null|                      null|                          null|                        null|                 null|                              null|                               null|                         null|                      null|                          null|                              null|                              1.470|                        1.308|                     0.550|                          null|                          null|                 null|                           null|                             0.001|                         null|                 null|                      null|                          null|                          null|                        null|                 null|                           null|                              null|                         null|                          null|                           null|                              null|                               null|                         null|                      null|                          null|                          null|                 null|                              null|\n+--------------------+--------------------+--------------------+-----------------------------+--------------------------+------------------------------+----------------------------+---------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+---------------------+--------------------------+------------------------------+------------------------------+----------------------------+---------------------+-------------------------------+----------------------------------+-----------------------------+------------------------------+-------------------------------+----------------------------------+-----------------------------------+-----------------------------+--------------------------+------------------------------+------------------------------+---------------------+----------------------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=75"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1612446356297_-594161915","id":"20210204-134556_1918699090","dateCreated":"2021-02-04T13:45:56+0000","dateStarted":"2021-02-04T16:28:52+0000","dateFinished":"2021-02-04T16:28:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9181"},{"text":"%spark2.pyspark\n","user":"bd01","dateUpdated":"2021-02-04T17:46:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612460787296_-654435820","id":"20210204-174627_513668353","dateCreated":"2021-02-04T17:46:27+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14065"},{"text":"%spark2.pyspark\ndf_residential.select(\"DE_KN_residential1_dishwasher\").describe()","user":"bd01","dateUpdated":"2021-02-04T17:00:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612452643541_2054737280","id":"20210204-153043_1199079094","dateCreated":"2021-02-04T15:30:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9182","dateFinished":"2021-02-04T16:20:41+0000","dateStarted":"2021-02-04T16:20:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[summary: string, DE_KN_residential1_dishwasher: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cl-hpsec1-50-gw-01-lx-ub18.lxd:4040/jobs/job?id=74"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\ncols_industrial  = get_categorical_colnames(cols, \"industrial\")\n","user":"bd01","dateUpdated":"2021-02-04T17:00:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1612455205971_-1053432588","id":"20210204-161325_1760667568","dateCreated":"2021-02-04T16:13:25+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10464"}],"name":"MEP / wdgubser / 500 Prototype 1","id":"2FX9Q8A1U","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"shUser:bd01:":[],"sh:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}